"use strict";!function(t,e,n){var i=function(i,o){var a={event:"click",noScroll:!1,closeOnOutsideClick:!0,fill:!1,allowEmptyHeader:!1,callback:!1,selfOpen:!1,onClose:!1};this.$body=t("body"),this.$element=t(i),this.identifier=this.$element.attr("data-overlay-open"),this.$content=t('[data-overlay-content="'+this.identifier+'"]'),this.isInTool=document.body.hasAttribute("data-istool"),this.options=t.extend(!0,a,o),this.closeEvent="click",this.hasHeader=!1,this.iOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!n.MSStream,this.$row=this.$content.closest(".row"),this.tabbableElements=t("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"),this.$element.attr("data-overlay-initonload")&&(this.options.selfOpen=!0),this.init(),e.touchevents&&(this.closeEvent="tap",this.options.event="tap")};i.prototype={init:function(){this.bindEvents(),this.options.selfOpen&&this.open()},open:function(e){var n=this;this.initElements(),this.isIframe=!1,this.$body.find("div[data-overlay-content]:visible .overlayClose").trigger("click"),this.$content.find(".iframeWrap").length>-1&&!this.isInTool&&(this.$content.find(".iframeWrap").html('<iframe id="legalIframe" src="'+this.$content.find(".iframeWrap").attr("data-iframesrc")+'"></iframe>'),this.isIframe=!0),this.iOS&&(this.$content.addClass("overlay-ios"),this.$content.find(".iframeWrap iframe").length>-1&&this.$content.find(".iframeWrap iframe").attr("scrolling","no")),t("<div class='overlayWrap' data-overlayid='"+this.identifier+"'>").insertBefore(this.$content).fadeIn(200),this.isIframe?this.$content.find(".iframeWrap iframe").ready(function(){n.$content.fadeIn(200)}):this.$content.fadeIn(200),this.assertScroll(),this.$body.css("overflow","hidden"),this.$row.css("z-index",20),this.toggleTabbingOnPage(!1),this.enableTabbingOnModal(),"function"==typeof this.options.callback&&this.options.callback(e)},close:function(e){e.preventDefault();var n=this;this.$content.fadeOut(200),t(".overlayWrap").fadeOut(200,function(){t(this).remove(),"function"==typeof n.options.onClose&&n.options.onClose(e)}),this.$body.css("overflow",""),this.$row.css("z-index","auto"),this.toggleTabbingOnPage(!0),t('[data-overlay-open="'+this.identifier+'"]').trigger("focus")},initElements:function(){var e="<a href='#' aria-label='Close' class='overlayClose'></a>";this.options.fill&&this.$content.addClass("overlay-fill"),(this.$content.find(".overlayTitle").length>0||this.$content.find(".overlaySubtitle")>0||this.options.allowEmptyHeader)&&0==this.$content.find(".overlayHeader").length?(this.$content.find(".overlayTitle").length>0||this.$content.find(".overlaySubtitle")>0?this.$content.find(".overlayTitle, .overlaySubtitle").wrapAll('<div class="overlayHeader"/>'):t('<div class="overlayHeader"/>').insertBefore(this.$content.find(">:first-child")),this.$content.find("a.overlayClose").length<1&&this.$content.find(".overlayHeader").append(e),this.hasHeader=!0):this.$content.find("a.overlayClose").length<1&&this.$content.append(e),this.$content.find("a.overlayClose").length<1&&this.$content.append(e)},assertScroll:function(){var t=this;n._monoLoader.utils.waitFor(function(){return!t.options.noScroll&&t.$content.outerHeight()<t.$content[0].scrollHeight},function(){0===t.$content.find("div.nano-content").length&&(t.hasHeader?(t.$content.children().not(".overlayHeader").wrapAll('<div class="nano"/>').wrapAll('<div class="nano-content hasHeader"/>'),t.$content.find(".nano").nanoScroller&&t.$content.find(".nano").nanoScroller({alwaysVisible:!0})):(t.$content.addClass("nano"),t.$content.children().wrapAll('<div class="nano-content"/>'),t.$content.nanoScroller&&t.$content.nanoScroller({alwaysVisible:!0})))},1e3,10)},bindEvents:function(){var e=this;t(this.$element).on(this.options.event,function(t){t.preventDefault();var i=t||n.event;e.open(i)}),this.$body.on(this.closeEvent+".overlayClose-"+this.identifier,'[data-overlay-content="'+this.identifier+'"] .overlayClose, [data-overlay-content="'+this.identifier+'"] .overlayCancel',t.proxy(this.close,this)),this.options.closeOnOutsideClick&&this.$body.on(this.closeEvent+".overlayClose-"+this.identifier,'.overlayWrap[data-overlayid="'+this.identifier+'"]',t.proxy(this.close,this))},toggleTabbingOnPage:function(e){var n=e?"0":"-1";t.each(this.tabbableElements,function(e,i){t(i).attr("tabindex",n)})},enableTabbingOnModal:function(){t("[data-overlay-content]").find(".overlayClose").attr("tabindex",0),t.each(this.tabbableElements,function(e,n){t(n).parents("[data-overlay-content]").length&&t(n).attr("tabindex","0")})}},t.fn.monooverlay=function(e){return this.each(function(){t.data(this,"monooverlay")||t.data(this,"monooverlay",new i(this,e))})}}(jQuery,Modernizr,window);